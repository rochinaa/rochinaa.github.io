<!DOCTYPE html>
<html lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="css/main.css" />
  <link rel="stylesheet" type="text/css" href="css/cpp.css" />
  <script type="text/javascript" src="script.js"></script>
  <link rel="icon" type="image/png" href="/favicon.png" />
  <title>Фильтры по классам</title>
</head>

<body onload="DocLoad()">
<p class="top"><a href="index.html#light_classfilters">Назад</a></p>
<div class="text">

<h1>Фильтры по классам</h1>

<p>Фильтры по классам появились в RDS начиная с версии 1.0.582. Поскольку информация
о фильтрах хранится в файле схемы, более старые версии RDS могут отказаться загружать
схему, сделанную в новой версии, если в этой схеме были созданы фильтры (даже если фильтры не
включены). Любые схемы, созданные в старых версиях RDS, должны, как обычно, загружаться в новой
версии без проблем.</p>

<p>К данному тексту прилагается
<a href="bin/classfilters_example.zip">пример схемы</a> с уже добавленными классами и фильтрами
(архив &laquo;<span class="file">zip</span>&raquo;,
2.02 кб).</p>

<div class="toc">
<div class="level">
  <p>Содержание:</p>
  <div class="level">
    <p><a href="#light_p1">1. Общий принцип действия и интерфейс пользователя</a></p>
        <div class="level">
          <p><a href="#light_p1_1">1.1. Устройство фильтров</a></p>
          <p><a href="#light_p1_2">1.2. Управление фильтрами в подсистеме</a></p>
        </div>
    <p><a href="#light_p2">2. Создание и редактирование фильтров</a></p>
  </div>

</div>
</div>

<h1 id="light_p1">1. Общий принцип действия и интерфейс пользователя</h1>

<p>Фильтры по классам позволяют управлять отображением блоков и связей в подсистеме в зависимости от
принадлежности этих объектов к заданным сочетаниям классов (см. &sect;2.12.2 описания
пользователя). Фильтры работают одновременно с установками видимости слоев и классов текущей
конфигурации подсистемы: для того, чтобы блок или связь отображались, они должны удовлетворять и
условиям видимости текущей конфигурации (находиться на видимом слое и принадлежать хотя бы к одному
видимому в конфигурации классу), и условиям всех включенных в данный момент фильтров. Все условия фильтров связаны
только с принадлежностью объектов к классам, но, в отличие от параметров конфигурации, эти условия могут
быть довольно сложными: можно, например, указывать одновременную принадлежность к нескольким классам
при помощи условия &laquo;И&raquo;.</p>

<p>Параметры конфигураций тоже позволяют управлять видимостью объектов согласно их классам. Однако, по
интерфейсу пользователя и логике работы фильтры отличаются от конфигураций:</p>

<ul>
  <li>Параметры каждой конфигурации относятся только к одной подсистеме, а набор фильтров &ndash;
  общий для всей схемы, как и набор классов объектов.</li>

  <li>В параметрах конфигурации можно только включать и выключать видимость отдельных классов в
  общем списке, а в фильтрах можно задать произвольное количество сложных условий,
  включающих операции &laquo;И&raquo; и &laquo;ИЛИ&raquo;, и дать каждому из условий и
  самому фильтру произвольные названия.</li>

  <li>В подсистеме только одна конфигурация может быть текущей, а фильтры можно включать
  в любом количестве независимо друг от друга.</li>

  <li>Блоки в схеме могут реагировать на переключение конфигураций (то есть схема
  может вести себя по-разному в зависимости от включенной конфигурации в каждой подсистеме),
  а включение и выключение фильтров влияет только на внешний вид подсистемы и не может
  быть обнаружено моделями блоков.</li>
</ul>

<p class="noindent">Следует учитывать, что при помощи фильтров можно только ограничить количество отображаемых
объектов. Нельзя отобразить объект, который уже не отображается по каким-либо причинам. Например, если
блок в подсистеме не рисуется, потому что его класс выключен в параметрах текущей конфигурации,
включение фильтра, в котором отображение этого класса разрешено, не приведет к появлению блока
в окне: его рисование <span class="emph">уже</span> запрещено. По этой причине не рекомендуется
использовать управление отображением одних и тех же классов и в фильтрах, и в параметрах конфигурации:
если какой-либо набор классов объектов предполагается использовать в фильтрах, для всех классов из этого
набора лучше всего включить отображение во всех конфигурациях.</p>

<p>Основное планируемое применение фильтров по классам &ndash; графовые модели. При создании модели
инженерных сетей здания, например, можно использовать конфигурации для переключения видимых
этажей здания, а фильтры &minus; для отображения сетей по типам: электрические, водоснабжения
и т.д.</p>


<h2 id="light_p1_1">1.1. Устройство фильтров</h2>

<p>Фильтры по классам блоков и связей, как и сами эти классы, относятся ко всей схеме, а не к какой-либо
конкретной подсистеме. По этой причине набор фильтров во всех окнах подсистем одинаковый, хотя
состояние фильтров (включены они или выключены) и выбранные варианты включенных фильтров в разных подсистемах
могут быть разными.</p>

<p>В схеме может быть произвольное количество фильтров, каждый из которых имеет
свое название и набор вариантов, из которых может выбирать пользователь (создание и редактирование фильтров
рассматривается в п.<a href="#light_p2">2</a>). Каждый вариант имеет свое название (уникальное в данном
фильтре) и логическое условие, которое определяет, соответствует ли объект (блок или связь) данному варианту данного
фильтра. Все условия связаны с принадлежностью объекта к одному или нескольким классам и могут включать
логические функции &laquo;И&raquo;, &laquo;ИЛИ&raquo; и
&laquo;НЕ&raquo;. На данный момент невозможно включить в фильтры условия, не
связанные с классами (поэтому они и называются
&laquo;фильтры по <span class="emph">классам</span>&raquo;):
например, нельзя сделать фильтр, разрешающий отображение только связей. Но это можно обойти, добавив
в схему новые классы и присвоив их соответствующим объектам. Если ввести класс &laquo;связь&raquo; и
присвоить его всем связям, можно будет управлять отображением связей по этому классу. Это, конечно,
менее удобно, чем если бы соответствующее условие можно было включить в фильтр непосредственно,
но для решения большинства задач вполне подходит.</p>

<p><span id="filtertype">Фильтр</span>
может принадлежать к одному из трех <span id="light_filtertype">типов</span> по влиянию выбранных вариантов
на отображение объектов в подсистеме:</p>

<ul>
  <li>Пользователь может выбрать любое число вариантов, объект будет отображаться в подсистеме
  только если он удовлетворяет условиям всех выбранных вариантов (множественный выбор
  по &laquo;и&raquo;).</li>

  <li>Пользователь может выбрать любое число вариантов, объект будет отображаться в подсистеме
  если он удовлетворяет условию хотя бы одного выбранного варианта (множественный выбор
  по &laquo;или&raquo;).</li>

  <li>Пользователь может выбрать только один вариант, объект будет отображаться в подсистеме
  если он удовлетворяет условию этого варианта.</li>
</ul>

<p class="noindent">Варианты фильтров разных типов визуально отображаются флажками
разного внешнего вида (см. п.<a href="#light_p1_2">1.2</a>).</p>

<p>Если в подсистеме включено несколько фильтров одновременно, объект будет отображаться
только если он удовлетворяет всем этим фильтрам, то есть включенные фильтры
всегда объединяются по &laquo;и&raquo;. Выключенные фильтры на отображение объектов не
влияют, но выбранные в них в последний раз варианты запоминаются в схеме, чтобы при
следующем включении фильтра его прошлые варианты автоматически выбрались.</p>

<h2 id="light_p1_2">1.2. Управление фильтрами в подсистеме</h2>

<p>Если в схеме есть хотя бы один фильтр (см. п.<a href="#light_p2">2</a>), в подменю
&laquo;подсистема&raquo; главного меню RDS и в подменю &laquo;вид&raquo;
контекстного (открывающегося по правой кнопке) меню будет присутствовать пункт
&laquo;фильтры по классам&raquo;. Выбор этого пункта включает в подсистеме
<a href="#pic1">панель фильтров</a> (повторный выбор пункта выключает эту панель).</p>


<div class="pic"><div class="container" id="pic1">
<img src="img/classfilters_examp.png" width="932" height="449" alt="Панель фильтров" />
<p id="light_pic1">Панель фильтров в окне подсистемы</p>
</div></div>

<p>Панель фильтров всегда находится в правой части окна подсистемы. Ее ширину можно изменять,
перетаскивая мышью разделитель между ней и рабочим полем. На панели отображаются названия
имеющихся в схеме фильтров с флажками для их включения. Для включения фильтра следует
щелкнуть левой кнопкой мыши по пустому квадрату слева от его названия, при этом в квадрате
появится галочка, а под названием фильтра развернется список его вариантов. Для выключения фильтра следует
снова щелкнуть левой кнопкой мыши по его квадрату с галочкой &ndash; галочка исчезнет, и
список вариантов свернется. На <a href="#pic1">рисунке</a> выше включены фильтры
&laquo;цвет&raquo;, &laquo;толщина линий&raquo; и &laquo;форма (только блоки)&raquo;,
а фильтр &laquo;буква&raquo; выключен.</p>

<p>Слева от названия каждого варианта также находится квадрат или круг, позволяющий
включать или выключать этот вариант щелчком мыши:</p>

<ul>
  <li>Если объект должен удовлетворять
  всем выбранным условиям фильтра, рядом с названиями выбранных вариантов такого
  фильтра отображается обычная галочка в квадрате (фильтр &laquo;цвет&raquo; на рисунке).</li>

  <li>Если объекту достаточно удовлетворять хотя бы
  одному выбранному условию фильтра, рядом с названиями выбранных вариантов такого
  фильтра отображается знак &laquo;плюс&raquo; в квадрате (фильтр &laquo;толщина линий&raquo;
  на рисунке).</li>

  <li>Если пользователь может выбрать в фильтре только одни вариант, рядом с названием
  выбранного варианта отображается точка в круге (фильтр &laquo;форма (только блоки)&raquo;
  на рисунке).</li>
</ul>

<p class="noindent">Закрыть панель фильтров можно не только повторным выбором пункта меню,
открывающего ее, но и кнопкой &laquo;x&raquo; в правой верхней части панели. Закрытие панели
не выключает фильтры: включенные фильтры продолжают влиять на отображение объектов, просто при
закрытой панели их нельзя изменять. Включенные фильтры, выбранные в них варианты, видимость и
размер панели сохраняются вместе со схемой, поэтому если при сохранении схемы какие-то фильтры
в подсистеме были включены, они будут включены и после загрузки этой схемы.</p>

<p><a href="#pic2">Флажки</a>, управляющие синхронизацией конфигурации подсистемы с ее родительской и вложенными
подсистемами, влияют и на фильтры. При включенных флажках включение, выключение и изменение
выбранных вариантов фильтра в одной подсистеме будет автоматически распространяться и
на другие подсистемы согласно этим флажкам.</p>

<div class="pic"><div class="container" id="pic2">
<img src="img/classfilters_sysparam.png" width="534" height="515" alt="Параметры подсистемы" />
<p id="light_pic2">Управление синхронизацией фильтров в параметрах подсистемы</p>
</div></div>


<h1 id="light_p2">2. Создание и редактирование фильтров</h1>

<p>Если в схеме есть хотя бы один класс (см. &sect;2.12.2 описания
пользователя), в подменю &laquo;система&raquo; главного меню RDS будет присутствовать
пункт &laquo;фильтры по классам&raquo; (доступен только в режиме редактирования),
открывающий <a href="#pic3">окно управления фильтрами</a>.</p>

<div class="pic"><div class="container" id="pic3">
<img src="img/classfilters_listwin.png" width="415" height="320" alt="Список фильтров" />
<p id="light_pic3">Окно управления фильтрами</p>
</div></div>

<p>Большую часть окна занимает список уже имеющихся в схеме фильтров (изначально пустой).
Справа от списка расположены кнопки управления:</p>

<div class="tablecenter"><div class="tcont">
<table>
  <tr>
    <th>Кнопка</th>
    <th>Действие</th>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_ArrowUp.png" width="25" height="25" alt="Кнопка: вверх" /></td>
    <td class="vcenter">Переместить фильтр на одну позицию вверх по списку.</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_ArrowDown.png" width="25" height="25" alt="Кнопка: вниз" /></td>
    <td class="vcenter">Переместить фильтр на одну позицию вниз по списку.</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_properties.png" width="25" height="25" alt="Кнопка: свойства" /></td>
    <td class="vcenter">Редактировать выбранный в списке фильтр.</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_Plus.png" width="25" height="25" alt="Кнопка: плюс" /></td>
    <td class="vcenter">Добавить новый фильтр в список.</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_Delete.png" width="25" height="25" alt="Кнопка: удалить" /></td>
    <td class="vcenter">Удалить выбранный в списке фильтр.</td>
  </tr>
</table>
</div></div>

<p>Порядок расположения фильтров в списке определяет их порядок на
<a href="#pic1">панели фильтров</a> в окне подсистемы (во всех подсистемах этот порядок один и тот же).
На работу фильтров их порядок не влияет, все они равноправны.
Нажатие кнопки &laquo;OK&raquo; передает в схему сделанные в окне изменения (добавление, изменение,
удаление, изменение порядка фильтров), нажатие кнопки &laquo;отмена&raquo; закрывает окно
без внесения изменений в схему.</p>

<p>При нажатии кнопок добавления нового или изменения выбранного фильтра открывается
<a href="#pic4">окно редактирования фильтра</a>, в котором задаются название и тип фильтра,
а также набор его вариантов с их логическими условиями.</p>

<div class="pic"><div class="container" id="pic4">
<img src="img/classfilters_editfilter.png" width="798" height="397" alt="Редактирование фильтра" />
<p id="light_pic4">Окно редактирования фильтра и его условий</p>
</div></div>


<p>В верхней части окна, на панели &laquo;фильтр&raquo;, вводится название фильтра для
панели в окне подсистемы и указывается его <a href="#filtertype">тип</a>, согласно которому
выбранные варианты влияют на отображение блоков и связей. В левой нижней части
окна, на панели &laquo;варианты выбора&raquo;, отображается список вариантов фильтра
(в порядке, соответствующем панели фильтров), которые можно добавлять, удалять и менять местами
при помощи кнопок:</p>

<div class="tablecenter"><div class="tcont">
<table>
  <tr>
    <th>Кнопка</th>
    <th>Действие</th>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_ArrowUp.png" width="25" height="25" alt="Кнопка: вверх" /></td>
    <td class="vcenter">Переместить вариант на одну позицию вверх по списку.</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_ArrowDown.png" width="25" height="25" alt="Кнопка: вниз" /></td>
    <td class="vcenter">Переместить вариант на одну позицию вниз по списку.</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_Plus.png" width="25" height="25" alt="Кнопка: плюс" /></td>
    <td class="vcenter">Добавить новый вариант в список вариантов (редактируется на панели справа).</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_Delete.png" width="25" height="25" alt="Кнопка: удалить" /></td>
    <td class="vcenter">Удалить выбранный в списке вариант.</td>
  </tr>
</table>
</div></div>

<p>В правой нижней части окна, на панели &laquo;параметры варианта&raquo;, для выбранного в левом списке
варианта вводится его название для панели в окне подсистемы и задаются логические условия.
Условия отображаются в виде
древовидного списка с простыми условиями (принадлежность к конкретному классу, отсутствие классов
и т.п.) на &laquo;листьях&raquo; дерева и операциями &laquo;И&raquo; и &laquo;ИЛИ&raquo;
(с возможным добавлением отрицания) в узлах. Справа от списка условий располагаются кнопки,
позволяющие добавлять, удалять и редактировать условия:</p>

<div class="tablecenter"><div class="tcont">
<table>
  <tr>
    <th>Кнопка</th>
    <th>Действие</th>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_Plus.png" width="25" height="25" alt="Кнопка: плюс" /></td>
    <td class="vcenter">Добавить новое условие (условие добавляется в ближайший к текущему
    выбранному условию узел &laquo;И&raquo; или &laquo;ИЛИ&raquo;). Для
    ввода добавляемого условия открывается отдельное окно.</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_properties.png" width="25" height="25" alt="Кнопка: свойства" /></td>
    <td class="vcenter">Редактировать выбранное условие (открывается отдельное окно).</td>
  </tr>
  <tr>
    <td class="allcenter"><img class="btn" src="img/Button_Delete.png" width="25" height="25" alt="Кнопка: удалить" /></td>
    <td class="vcenter">Удалить выбранное условие.</td>
  </tr>
</table>
</div></div>

<p>При нажатии кнопки добавления или редактирования условия открывается отдельное
<a href="#pic5">окно</a>, в котором задается конкретное логическое условие.</p>

<div class="pic"><div class="container" id="pic5">
<img src="img/classfilters_editcondition.png" width="798" height="307" alt="Условие фильтра" />
<p id="light_pic5">Окно задания условия фильтра</p>
</div></div>

<p>В левой части окна перечислены все реализованные на данный момент условия, из которых можно
выбрать нужное. В правой части находится список классов, в котором для условий, связанных
с принадлежностью объекта к конкретному классу, следует выбрать этот класс.</p>

<hr />
</div>

<p class="bottom"><a href="index.html#light_uitranslate">Назад</a></p>

</body>
</html>
